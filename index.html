<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2 IT</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <style>
        main {
            /* Sentrer divisjonen */
            margin-left: auto !important;
            margin-right: auto !important;
        }
    </style>
    <style>
        calculator > * {
        display: flex;
        flex-direction: column;
        }

        input, select {
            border-radius: 5px;
            margin-bottom: 5px;
        }

        calculator {
            background-color: rgb(221, 221, 221);
            border-radius: 10px;
            padding: 20px;
        }

        .kjoredistanse, .co2 {
            margin-bottom: 35px;
        }

        label {
            font-weight: bold;
        }
    </style>
</head>
<body>
    <main class="container mt-5 row">
        <calculator-wrapper class="col-6 h-100 pe-5">
            <calculator class="d-flex flex-column">
                <h2>CO2 - Utslippskalkulator</h2>
                <div class="kjoredistanse d-flex flex-column">
                    <label for="kjøredistanse">kjøredistanse (km):</label>
                    <input type="number" name="kjøredistanse" value="0">
                </div>
                <div class="co2">
                    <p><strong>1. Etter CO2 utslipp</strong></p>
                    <label for="Etter_CO2_utslipp">Bilens Co2 utslipp per km (gram):</label>
                    <input type="number" name="Etter_CO2_utslipp" value="0">
                    <label for="Etter_CO2_utslipp_result">Utslipp i Kg:</label>
                    <input disabled type="number" class="result" name="Etter_CO2_utslipp_result" id="Etter_CO2_utslipp_result" value="0">
                </div>
                <div class="forbruk">
                    <p><strong>2. Etter forbruk per mil</strong></p>
                    <label for="Etter_forbruk_per_mil">Bilens drivstofforbruk per mil:</label>
                    <input type="number" name="Etter_forbruk_per_mil" value="0">
                    <label for="Fuel">Drivstoff:</label>
                    <select name="Fuel" id="fuel">
                        <option value="Gas">Bensin</option>
                        <option value="Diesel">Diesel</option>
                    </select>
                    <label for="Etter_forbruk_per_mil_result">Utslipp i Kg:</label>
                    <input disabled type="number" class="result" name="Etter_forbruk_per_mil_result" id="Etter_forbruk_per_mil_result" value="0">
                </div>
            </calculator>
        </calculator-wrapper>

        <article class="col-6">
            {% for section in sections %}
                <section>
                    <!-- Om en tittel for seksjonen ikke er definert, så vil tittelen være lagret som None. Om den er det, så viser vi ikke tittelen. -->
                    {% if section.title != None %}
                        <h1>{{section.title}}</h1>
                    {% endif %}

                    <p>{{section.content|safe}}</p>
                </section>
            {% endfor %}
        </article>
        </main>
        <script type="text/javascript">
            
        function calculateEmmisions() { 
            // Etter CO2 utslipp
            // Hent verdiene fra inputtene
            let drivingDistance = document.getElementsByName("kjøredistanse")[0].value
            let Co2Emisions = document.getElementsByName("Etter_CO2_utslipp")[0].value

            let resultInput = document.getElementsByName("Etter_CO2_utslipp_result")[0]

            // Vi må først gjøre at inputten ikke er disabled før vi endrer verdien. Etter det gjør vi den disabled igjen så brukeren ikke kan endre på den.
            resultInput.disabled = false
            resultInput.value = drivingDistance * (Co2Emisions / 1000)
            resultInput.disabled = true
        }

        function calculateEmmisionsPerLength() {
            // Etter forbruk per mil
            // Hent verdiene fra inputtene
            let drivingDistance = document.getElementsByName("kjøredistanse")[0].value
            let Co2EmisionsLength = document.getElementsByName("Etter_forbruk_per_mil")[0].value
            let fuelType = document.getElementsByName("Fuel")[0]
            fuelType = fuelType[fuelType.selectedIndex].value


            let resultInput = document.getElementsByName("Etter_forbruk_per_mil_result")[0]

            // Gjør at inputten ikke er disabled, og gjør kalkulasjoner basert på drivstofftypen før vi gjør inputten disabled igjen.
            resultInput.disabled = false
            if (fuelType == "Gas"){
                resultInput.value = (drivingDistance * Co2EmisionsLength * 2.32) / 10
            } else {
                resultInput.value = (drivingDistance * Co2EmisionsLength * 2.66) / 10
            }
            resultInput.disabled = true
        }

    
        document.getElementsByName("Etter_CO2_utslipp")[0].onchange = addEventListener("change", calculateEmmisions)
        document.getElementsByName("Etter_forbruk_per_mil")[0].onchange = addEventListener("change", calculateEmmisionsPerLength)
        </script>
    </body>
</html>